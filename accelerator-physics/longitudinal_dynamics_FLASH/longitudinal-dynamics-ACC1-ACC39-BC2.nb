(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     54603,       1195]
NotebookOptionsPosition[     52869,       1149]
NotebookOutlinePosition[     53205,       1164]
CellTagsIndexPosition[     53162,       1161]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Apparently, the phase of the third harmonic module is not that important, \
except it should be around 180 deg. Changing by +- 10 degrees doesn\
\[CloseCurlyQuote]t seem to make a difference as far as linearity of the \
phase space is concerned.
It does affect the chirp though.\
\>", "Text",
 CellChangeTimes->{{3.6520907276642647`*^9, 3.652090778983677*^9}, {
  3.6521002812994957`*^9, 3.652100285476583*^9}, {3.6521003185408907`*^9, 
  3.652100357506302*^9}, {3.652100414409684*^9, 
  3.6521004317936373`*^9}},ExpressionUUID->"e1ecb0fe-3d19-4cb6-9cbf-\
8f8d840c61be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"Manipulator", ",", 
    RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.652096800995491*^9, 3.652096802197879*^9}, 
   3.652099731717013*^9, 
   3.652099762797611*^9},ExpressionUUID->"e61e06a4-606e-4bae-a2ae-\
ac47e515f92e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{"1.3", " ", 
    SuperscriptBox["10", "9"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"3", " ", 
    SuperscriptBox["10", "8"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", "=", 
   RowBox[{"1", "/", "f"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]", "=", 
   RowBox[{"c", " ", "T"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", 
   RowBox[{"2", 
    RowBox[{"\[Pi]", "/", "\[Lambda]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VACC1", "=", "150"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6520967133499727`*^9, 3.6520967546073647`*^9}, {
   3.652096793270381*^9, 3.6520968382779427`*^9}, {3.6520969418363247`*^9, 
   3.652096943476639*^9}, {3.652096991316164*^9, 3.652097014587493*^9}, 
   3.652097251840014*^9, {3.652097470812581*^9, 3.652097493676259*^9}, {
   3.707453713715416*^9, 3.707453723319706*^9}, {3.7074677707745943`*^9, 
   3.707467776332095*^9}, {3.7074679713787327`*^9, 3.7074679718821163`*^9}, {
   3.7504896277384*^9, 
   3.750489628227684*^9}},ExpressionUUID->"9e2969cd-09fc-41a4-80e2-\
ea427fb23413"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"W", "[", 
   RowBox[{"z_", ",", "V_", ",", " ", "\[Phi]_", ",", "k_"}], " ", "]"}], ":=", 
  RowBox[{"V", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"k", " ", "z"}], " ", "+", " ", 
     RowBox[{"Degree", " ", "\[Phi]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WACC1", "[", 
   RowBox[{"z_", ",", "\[Phi]_"}], "]"}], ":=", 
  RowBox[{"W", "[", 
   RowBox[{"z", ",", " ", "VACC1", ",", " ", "\[Phi]", ",", " ", "k"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WACC39", "[", 
   RowBox[{"z_", ",", "\[Phi]_", ",", "ratio_"}], "]"}], ":=", 
  RowBox[{"W", "[", 
   RowBox[{"z", ",", " ", 
    RowBox[{"VACC1", "/", "ratio"}], ",", " ", "\[Phi]", ",", " ", 
    RowBox[{"3", "k"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wtot", "[", 
   RowBox[{"z_", ",", "\[Phi]ACC1_", ",", "\[Phi]ACC39_", ",", "ratio_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"WACC1", "[", 
    RowBox[{"z", ",", " ", "\[Phi]ACC1"}], "]"}], "+", 
   RowBox[{"WACC39", "[", 
    RowBox[{"z", ",", " ", "\[Phi]ACC39", ",", "ratio"}], "]"}]}]}]}], "Input",\

 CellChangeTimes->{{3.652096736450639*^9, 3.6520967393428183`*^9}, 
   3.6520969401712837`*^9, {3.6520972844876003`*^9, 3.652097302966655*^9}, {
   3.652097523979858*^9, 3.652097632746924*^9}, {3.652098149955378*^9, 
   3.652098165700821*^9}, {3.652098198547893*^9, 3.65209827001044*^9}, {
   3.652098315649835*^9, 3.65209833444143*^9}, {3.6520986166463757`*^9, 
   3.652098639893683*^9}, {3.652098828548328*^9, 3.652098837043847*^9}, {
   3.65209897817971*^9, 3.6520990039690857`*^9}, {3.70746778485427*^9, 
   3.707467813220326*^9}},ExpressionUUID->"ed396355-5d8b-46c0-aa50-\
c5ebd509f57f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Plot", "[", " ", "\[IndentingNewLine]", "          ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Wtot", "[", 
        RowBox[{"z", ",", "\[Phi]ACC1", ",", "\[Phi]ACC39", ",", "ratio"}], 
        "]"}], ",", " ", 
       RowBox[{"WACC1", "[", 
        RowBox[{"z", ",", "\[Phi]ACC1"}], "]"}], ",", 
       RowBox[{"WACC39", "[", 
        RowBox[{"z", ",", "\[Phi]ACC39", ",", "ratio"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", "          ", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{"-", "0.1"}], ",", "0.1"}], "}"}], ",", "\[IndentingNewLine]", 
     "           ", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "170"}], ",", "170"}], "}"}]}], ",", 
     "\[IndentingNewLine]", "            ", 
     RowBox[{"PlotLegends", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Total\>\"", ",", " ", "\"\<ACC1\>\"", ",", " ", "\"\<ACC39\>\""}],
        "}"}]}], ",", "\[IndentingNewLine]", "           ", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Grid", "@", 
       RowBox[{
       "{", "\[IndentingNewLine]", 
        "                                             ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Optimal ratio=\>\"", ",", 
           RowBox[{
            RowBox[{"-", "9"}], 
            FractionBox[
             RowBox[{"Cos", "[", 
              RowBox[{"Degree", " ", "\[Phi]ACC39"}], "]"}], 
             RowBox[{"Cos", "[", 
              RowBox[{"Degree", " ", "\[Phi]ACC1"}], "]"}]]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         "                                             ", 
         RowBox[{"{", 
          RowBox[{"\"\<1st derivative (chirp)=\>\"", ",", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"Wtot", "[", 
               RowBox[{
               "z", ",", "\[Phi]ACC1", ",", "\[Phi]ACC39", ",", "ratio"}], 
               "]"}], ",", "z"}], "]"}], "/.", 
            RowBox[{"z", "\[Rule]", "0"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         "                                             ", 
         RowBox[{"{", 
          RowBox[{"\"\<2nd derivative=\>\"", ",", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"Wtot", "[", 
                 RowBox[{
                 "z", ",", "\[Phi]ACC1", ",", "\[Phi]ACC39", ",", "ratio"}], 
                 "]"}], ",", "z"}], "]"}], ",", "z"}], "]"}], "/.", 
            RowBox[{"z", "\[Rule]", "0"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         "                                             ", 
         RowBox[{"{", 
          RowBox[{"\"\<3rd derivative=\>\"", ",", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"Wtot", "[", 
                   RowBox[{
                   "z", ",", "\[Phi]ACC1", ",", "\[Phi]ACC39", ",", "ratio"}],
                    "]"}], ",", "z"}], "]"}], ",", "z"}], "]"}], ",", "z"}], 
             "]"}], "/.", 
            RowBox[{"z", "\[Rule]", "0"}]}]}], "}"}]}], "\[IndentingNewLine]",
         "    ", "}"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Phi]ACC1", ",", "0"}], "}"}], ",", 
     RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", "\[IndentingNewLine]", 
   "   ", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Phi]ACC39", ",", "180"}], "}"}], ",", 
     RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ratio", ",", "9"}], "}"}], ",", "1", ",", "20"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6470774787781897`*^9, 3.6470774835113897`*^9}, {
   3.647077516391523*^9, 3.6470775957040243`*^9}, {3.647077642720669*^9, 
   3.647077736677991*^9}, {3.647077829142878*^9, 3.647077859149127*^9}, {
   3.6470778935092154`*^9, 3.647077907412652*^9}, {3.6519025012246227`*^9, 
   3.651902533208329*^9}, {3.652077344727631*^9, 3.6520773500710163`*^9}, {
   3.652077407998869*^9, 3.652077431455084*^9}, {3.652077530151039*^9, 
   3.6520776565373707`*^9}, {3.652081938206974*^9, 3.65208196076478*^9}, {
   3.65208205590991*^9, 3.652082099487801*^9}, {3.652082168220787*^9, 
   3.652082248323018*^9}, {3.6520823251945887`*^9, 3.6520823567627497`*^9}, 
   3.652082390642067*^9, {3.652082762437989*^9, 3.652082782118401*^9}, {
   3.652083814601267*^9, 3.652083895564883*^9}, {3.652083926565282*^9, 
   3.6520839865407248`*^9}, {3.652090800781726*^9, 3.6520908198374987`*^9}, {
   3.652090874900503*^9, 3.652090941444323*^9}, {3.6520910150433397`*^9, 
   3.6520910844732027`*^9}, {3.652091125985696*^9, 3.652091189177298*^9}, {
   3.652097623502788*^9, 3.6520976996460867`*^9}, {3.6520978377712803`*^9, 
   3.65209785488686*^9}, {3.652098082079487*^9, 3.6520981635497627`*^9}, {
   3.652098274188587*^9, 3.652098307483779*^9}, {3.652098648344185*^9, 
   3.6520987405017977`*^9}, {3.652098800421707*^9, 3.652098802227398*^9}, {
   3.652098839868978*^9, 3.652098842826693*^9}, {3.652098992170512*^9, 
   3.6520989937143717`*^9}, {3.652099042226321*^9, 3.652099084961936*^9}, {
   3.6520991889602337`*^9, 3.652099274783535*^9}, {3.652099380861855*^9, 
   3.6520994155648003`*^9}, {3.652099453061633*^9, 3.652099517468397*^9}, 
   3.652099630498204*^9, {3.65209966693812*^9, 3.652099686025323*^9}, {
   3.6520997371012707`*^9, 3.6520997448011093`*^9}, {3.652099845087864*^9, 
   3.652099845244388*^9}, {3.70746770605639*^9, 3.707467756944145*^9}, {
   3.707467817063777*^9, 3.707467823145597*^9}, {3.707467860904499*^9, 
   3.7074678678454514`*^9}, {3.707468000998701*^9, 3.7074680011702833`*^9}, 
   3.707468041311438*^9, {3.707477495702663*^9, 3.70747749606222*^9}, {
   3.7074815452978163`*^9, 3.7074815454613047`*^9}, {3.750586797823936*^9, 
   3.750586850070464*^9}, {3.750586914739311*^9, 3.750586951153318*^9}, {
   3.7505871508814898`*^9, 3.75058739676103*^9}, {3.750588923846293*^9, 
   3.7505889874823236`*^9}, {3.7505895621164618`*^9, 3.750589677767412*^9}, {
   3.750589746813931*^9, 3.750589877151926*^9}, {3.75058992667787*^9, 
   3.750590058608344*^9}},ExpressionUUID->"63f240a5-162a-463a-9f55-\
07e2334038d3"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`ratio$$ = 9, $CellContext`\[Phi]ACC1$$ = 
    0, $CellContext`\[Phi]ACC39$$ = 180, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`\[Phi]ACC1$$], 0}, -180, 180}, {{
       Hold[$CellContext`\[Phi]ACC39$$], 180}, -180, 180}, {{
       Hold[$CellContext`ratio$$], 9}, 1, 20}}, Typeset`size$$ = {
    454., {139., 143.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`\[Phi]ACC1$120146$$ = 
    0, $CellContext`\[Phi]ACC39$120147$$ = 0, $CellContext`ratio$120148$$ = 
    0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`ratio$$ = 9, $CellContext`\[Phi]ACC1$$ = 
        0, $CellContext`\[Phi]ACC39$$ = 180}, "ControllerVariables" :> {
        Hold[$CellContext`\[Phi]ACC1$$, $CellContext`\[Phi]ACC1$120146$$, 0], 
        
        Hold[$CellContext`\[Phi]ACC39$$, $CellContext`\[Phi]ACC39$120147$$, 
         0], 
        Hold[$CellContext`ratio$$, $CellContext`ratio$120148$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Plot[{
         $CellContext`Wtot[$CellContext`z, $CellContext`\[Phi]ACC1$$, \
$CellContext`\[Phi]ACC39$$, $CellContext`ratio$$], 
         $CellContext`WACC1[$CellContext`z, $CellContext`\[Phi]ACC1$$], 
         $CellContext`WACC39[$CellContext`z, $CellContext`\[Phi]ACC39$$, \
$CellContext`ratio$$]}, {$CellContext`z, -0.1, 0.1}, PlotRange -> {-170, 170},
         PlotLegends -> {"Total", "ACC1", "ACC39"}, PlotLabel -> 
        Grid[{{"Optimal ratio=", (-9) (Cos[Degree $CellContext`\[Phi]ACC39$$]/
             Cos[Degree $CellContext`\[Phi]ACC1$$])}, {
           "1st derivative (chirp)=", 
            ReplaceAll[
             D[
              $CellContext`Wtot[$CellContext`z, $CellContext`\[Phi]ACC1$$, \
$CellContext`\[Phi]ACC39$$, $CellContext`ratio$$], $CellContext`z], \
$CellContext`z -> 0]}, {"2nd derivative=", 
            ReplaceAll[
             D[
              D[
               $CellContext`Wtot[$CellContext`z, $CellContext`\[Phi]ACC1$$, \
$CellContext`\[Phi]ACC39$$, $CellContext`ratio$$], $CellContext`z], \
$CellContext`z], $CellContext`z -> 0]}, {"3rd derivative=", 
            ReplaceAll[
             D[
              D[
               D[
                $CellContext`Wtot[$CellContext`z, $CellContext`\[Phi]ACC1$$, \
$CellContext`\[Phi]ACC39$$, $CellContext`ratio$$], $CellContext`z], \
$CellContext`z], $CellContext`z], $CellContext`z -> 0]}}]], 
      "Specifications" :> {{{$CellContext`\[Phi]ACC1$$, 0}, -180, 
         180}, {{$CellContext`\[Phi]ACC39$$, 180}, -180, 
         180}, {{$CellContext`ratio$$, 9}, 1, 20}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{501., {241., 246.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.7505899289336777`*^9, 3.750589972987924*^9}, {
  3.750590023390094*^9, 
  3.7505900548838587`*^9}},ExpressionUUID->"e62f4fa0-4745-44af-b5db-\
b4763e4a4be4"]
}, Open  ]],

Cell["Define and plot particle distribution after the gun", "Text",
 CellChangeTimes->{
  3.7074721464009933`*^9},ExpressionUUID->"b4f5511c-ad38-4012-8c0f-\
e87922ba57be"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Nparticles", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]zGun", "=", 
    RowBox[{"1", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "3"}]]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"1", "mm"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EGun", "=", "5"}], ";"}], " ", 
  RowBox[{"(*", "MeV", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R56", "=", "0.18"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nbins", "=", "30"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zGun", "=", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"NormalDistribution", "[", 
      RowBox[{"0", ",", "\[Sigma]zGun"}], "]"}], ",", "Nparticles"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]Gun", "=", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"UniformDistribution", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], "]"}], ",", "Nparticles"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.707472305801592*^9, 3.70747232039345*^9}, {
   3.707472378058278*^9, 3.707472378184787*^9}, {3.7074735110110064`*^9, 
   3.707473512490054*^9}, {3.707475027407329*^9, 3.707475028822626*^9}, {
   3.707475267507354*^9, 3.707475268971463*^9}, {3.707477993296269*^9, 
   3.707477994960545*^9}, 3.707478166454248*^9, {3.707478310805502*^9, 
   3.7074783108591623`*^9}, 
   3.707479208024538*^9},ExpressionUUID->"a99dbb26-05ae-4e90-bb96-\
3070add2100c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"zGunPlot", "=", 
   RowBox[{"Histogram", "[", 
    RowBox[{"zGun", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Raw\>\"", ",", "Nbins"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "4"}], "*", "\[Sigma]zGun"}], ",", 
          RowBox[{"4", "*", "\[Sigma]zGun"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"Nparticles", "/", "10"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<z, [m]\>\"", ",", "\"\<Entries\>\""}], "}"}]}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z\[Delta]GunPlot", "=", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"zGun", "[", 
          RowBox[{"[", "n", "]"}], "]"}], ",", 
         RowBox[{"\[Delta]Gun", "[", 
          RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "Nparticles"}], "}"}]}], "]"}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<z, [m]\>\"", ",", "\"\<\[Delta]\>\""}], "}"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsRow", "[", 
  RowBox[{"{", 
   RowBox[{"zGunPlot", ",", "z\[Delta]GunPlot"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7074721189884577`*^9, 3.7074721191487837`*^9}, {
  3.7074779995620937`*^9, 3.707478000041656*^9}, {3.707478127185499*^9, 
  3.707478155088387*^9}, {3.707478280423192*^9, 3.707478305094275*^9}, {
  3.707478471180786*^9, 
  3.707478473884541*^9}},ExpressionUUID->"9c7f2bf6-f2cb-4eee-91c3-\
c16ac1404622"],

Cell[BoxData[
 GraphicsBox[{{}, {{InsetBox[
      GraphicsBox[{{
         {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], 
          EdgeForm[{Opacity[0.476], Thickness[Small]}], {}, {
           {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], 
            EdgeForm[{Opacity[0.476], Thickness[
            Small]}], {{
              RectangleBox[{-0.0031088486359941766, 0}, {-0.00288678801913745, 3.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{-0.00288678801913745, 0}, {-0.002664727402280723, 1.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{-0.002664727402280723, 0}, {-0.002442666785423996, 4.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{-0.002442666785423996, 0}, {-0.002220606168567269, 7.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{-0.002220606168567269, 0}, {-0.0019985455517105423, 12.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{-0.0019985455517105423, 0}, {-0.0017764849348538153, 13.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{-0.0017764849348538153, 0}, {-0.0015544243179970883, 18.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{-0.0015544243179970883, 0}, {-0.0013323637011403615, 25.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{-0.0013323637011403615, 0}, {-0.0011103030842836347, 41.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{-0.0011103030842836347, 0}, {-0.000888242467426908, 61.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{-0.000888242467426908, 0}, {-0.0006661818505701808, 60.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{-0.0006661818505701808, 0}, {-0.000444121233713454, 57.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{-0.000444121233713454, 0}, {-0.0002220606168567272, 94.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{-0.0002220606168567272, 0}, {0., 90.},
               RoundingRadius->0]}}, {{
              RectangleBox[{0., 0}, {0.00022206061685672678, 74.},
               RoundingRadius->0]}}, {{
              RectangleBox[{0.00022206061685672678, 0}, {0.00044412123371345355, 77.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{0.00044412123371345355, 0}, {0.0006661818505701803, 90.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{0.0006661818505701803, 0}, {0.0008882424674269071, 79.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{0.0008882424674269071, 0}, {0.0011103030842836339, 56.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{0.0011103030842836339, 0}, {0.0013323637011403607, 43.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{0.0013323637011403607, 0}, {0.0015544243179970883, 42.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{0.0015544243179970883, 0}, {0.001776484934853815, 23.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{0.001776484934853815, 0}, {0.001998545551710542, 9.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{0.001998545551710542, 0}, {0.0022206061685672686, 10.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{0.0022206061685672686, 0}, {0.0024426667854239954, 5.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{0.0024426667854239954, 0}, {0.002664727402280722, 4.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{0.002664727402280722, 0}, {0.002886788019137449, 1.},
               
               RoundingRadius->0]}}, {{
              RectangleBox[{0.0033309092528509034, 0}, {0.00355296986970763, 1.},
               
               
               RoundingRadius->
                0]}}}}, {}, {}}}, {{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}}},
       AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
       Axes->{True, True},
       AxesLabel->{
         FormBox["\"z, [m]\"", TraditionalForm], 
         FormBox["\"Entries\"", TraditionalForm]},
       AxesOrigin->{-0.0041600000000000005`, 0},
       FrameLabel->{{None, None}, {None, None}},
       FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
       GridLines->{None, None},
       GridLinesStyle->Directive[
         GrayLevel[0.5, 0.4]],
       PlotRange->NCache[{{
           Rational[-1, 250], 
           Rational[1, 250]}, {0, 100}}, {{-0.004, 0.004}, {0, 100}}],
       PlotRangePadding->{{
          Scaled[0.02], 
          Scaled[0.02]}, {
          Scaled[0.02], 
          Scaled[0.05]}},
       Ticks->{Automatic, Automatic}], {192., -116.80842387373012}, 
      ImageScaled[{0.5, 0.5}], {360., 222.49223594996212}], InsetBox[
      GraphicsBox[{{}, {{{}, {
           {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
            0.004583333333333334], AbsoluteThickness[1.6], 
            PointBox[CompressedData["
1:eJxNe3c41+8Xt5G9R/aIECGEULJKRiF7k1XKiDJCRKmMjGxFQ5RZWhJCZWd+
SyVlR1lJmqjnea7r+d0v/dN1rvO+35/7PuN1Xufcb2LuRy28qCgoKD5RU1D8
v/99C36351TZNlD8/38zPHFCtyJ0tP8nD2e+lXsbs4vIo+uEPGtK3PB8Fvve
riYLolcLbjxpoGOK59tnf068wPu/X+Jk9koxJvL4aHRvaq8heZ5eaYxnOkuW
6CuGlFinVPcTuXb0hy4tM963qSezUc/MnKyno5+1ENlsT/Td+ioMh85aEX1i
TIuBRuc+og/sG985ocBPZHNrNaef/dBv2CywTMWpSGSdfvf3nTWWRObjrtjk
2mRD5O0l5jdr15kR+et2q6LPEo7k9y/Fxx4e7tci8tcdlrm6Z9XJ80zx8jyB
KWZEXxd2M73FE+ubdbZtzF6/j8hBb6pNnCVMyfrjBi2MG5JsiX7s4uZdNO+t
cJ47+ssPu+HfoWeuzTOizrDvjjs9mcesiZ5jPO5dm6810d+Xzvn7qNiA6MvY
535WZMC+rDynpQ59UyXP7/osamj2QInIU93zLM/N3cjzj5XuhubZGRB9jmnd
OrsHykQ/ozEQWb/G/3xjmyqy1ByI/mm85uDmA9pETllyFmgW0yfPF7sq/L2Y
IU70Ex+T86LlEC/Obr+k2IT2ELnAX8z7Z745Wd9n7f920gnn9+NQ4ZjXHdX6
nzyakj3w6D89oo/Mc55b9II/It8/FGZZEy+DjxbrbVpgLw63WKuOCguiX7D3
OPT40VaiV2mY7XjBp0L0V1s4h+s2/aj/nyz873ZFPx3yya9cg0VoWYKsP3fu
zjf3+jX76bcuf9eD5/dIvpf0GuMlsmufVWJoMPL9dZLao9w/8M9B31gZnWqs
39gyXlQ6pU3klzKmilTcu4l8/m8bD/dLPfK+dQeqDzcdQ/xdom9Kf/EK/iyy
7A2Je4nf64l3WN1upkj0mvsvGNbkbSFyQs3hhLZUxJf9/ljPQCZ1oq90PrYj
basr9kc3KcSvjnyKlNVXfdePeO+7WMflG4b4aW4SvRQ5ifcXvDezlmXeRWTF
+gZl8Q7g3dTZGjGtODsi24sHfXuqQkmev6ajJMt+H/F3n673nfuZ7fC3VO7R
ym+IVwmj1fy6yHVEPv/jsjOTJvwjw5f3KKFcn8jydZt4huv2Ejlj7pJLsZAG
+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
+7jldS4sz9CvWPnd7RcYwn3Y/wGY3IT6
             
             "]]}}, {}}}, {}, {}, {{}, {}}, {{}, {}}},
       AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
       Axes->{True, True},
       AxesLabel->{
         FormBox["\"z, [m]\"", TraditionalForm], 
         FormBox["\"\[Delta]\"", TraditionalForm]},
       AxesOrigin->{0, 0},
       DisplayFunction->Identity,
       Frame->{{False, False}, {False, False}},
       FrameLabel->{{None, None}, {None, None}},
       FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
       GridLines->{None, None},
       GridLinesStyle->Directive[
         GrayLevel[0.5, 0.4]],
       ImagePadding->All,
       Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
             (Identity[#]& )[
              Part[#, 1]], 
             (Identity[#]& )[
              Part[#, 2]]}& ), "CopiedValueFunction" -> ({
             (Identity[#]& )[
              Part[#, 1]], 
             (Identity[#]& )[
              Part[#, 2]]}& )}},
       PlotRange->{{-0.0030646671842197697`, 0.0033750907046253102`}, {-1., 
        1.}},
       PlotRangeClipping->True,
       PlotRangePadding->{{
          Scaled[0.02], 
          Scaled[0.02]}, {
          Scaled[0.05], 
          Scaled[0.05]}},
       Ticks->{Automatic, Automatic}], {576., -116.80842387373012}, 
      ImageScaled[{0.5, 0.5}], {360., 222.49223594996212}]}}, {}},
  ContentSelectable->True,
  PlotRangePadding->{6, 5}]], "Output",
 CellChangeTimes->{
  3.7074721239752197`*^9, 3.707472381503957*^9, 3.707473516427767*^9, 
   3.707476044896448*^9, 3.7074780193224916`*^9, 3.7074781704962273`*^9, {
   3.707478286816372*^9, 3.707478313462687*^9}, 3.707478475161772*^9, 
   3.70747921239218*^9, 3.7074813628339252`*^9, 3.7074814133537693`*^9, 
   3.707552860832913*^9, 3.707553031659072*^9, 3.750489559467355*^9, 
   3.750586613852234*^9},ExpressionUUID->"8453ef13-cafc-4e18-97e5-\
ec7a723b0273"]
}, Open  ]],

Cell["Track through ACC1,  ACC39 and BC2", "Text",
 CellChangeTimes->{{3.707472164896667*^9, 3.707472177168605*^9}, {
  3.7074746356565533`*^9, 
  3.707474641256706*^9}},ExpressionUUID->"ec4cdc20-f378-4a38-b337-\
9ed9572afe0d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"track", " ", "through", " ", "ACC1", " ", "and", " ", "ACC39"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Delta]ACC39", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "Nparticles"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"EACC39", "=", 
     RowBox[{"EGun", "+", 
      RowBox[{"Wtot", "[", 
       RowBox[{"0", ",", "\[Phi]ACC1", ",", "\[Phi]ACC39", ",", "ratio"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Delta]ACC39", "[", 
        RowBox[{"[", "n", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"\[Delta]Gun", "[", 
              RowBox[{"[", "n", "]"}], "]"}]}], ")"}], "*", "EGun"}], "+", 
          RowBox[{"Wtot", "[", 
           RowBox[{
            RowBox[{"zGun", "[", 
             RowBox[{"[", "n", "]"}], "]"}], ",", "\[Phi]ACC1", ",", 
            "\[Phi]ACC39", ",", "ratio"}], "]"}], "-", "EACC39"}], ")"}], "/",
         "EACC39"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "Nparticles"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"zACC39", "=", "zGun"}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "plot", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"zACC39Plot", "=", 
     RowBox[{"Histogram", "[", 
      RowBox[{"zACC39", ",", "Nbins", ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<z, [m]\>\"", ",", "\"\<Entries\>\""}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "4"}], "*", "\[Sigma]zGun"}], ",", 
            RowBox[{"4", "*", "\[Sigma]zGun"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Nparticles", "/", "10"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<after ACC39\>\""}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"z\[Delta]ACC39Plot", "=", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"zACC39", "[", 
            RowBox[{"[", "n", "]"}], "]"}], ",", 
           RowBox[{"\[Delta]ACC39", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "Nparticles"}], "}"}]}], "]"}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<z, [m]\>\"", ",", "\"\<\[Delta]\>\""}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], "*", "\[Sigma]zGun"}], ",", 
            RowBox[{"3", "*", "\[Sigma]zGun"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.05"}], ",", "0.05"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<after ACC39\>\""}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"track", " ", "through", " ", "BC2"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"\[Delta]BC2", "=", "\[Delta]ACC39"}], ";", "\[IndentingNewLine]", 
    RowBox[{"zBC2", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "Nparticles"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"zBC2", "[", 
        RowBox[{"[", "n", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"zACC39", "[", 
         RowBox[{"[", "n", "]"}], "]"}], "+", 
        RowBox[{"R56", "*", 
         RowBox[{"\[Delta]ACC39", "[", 
          RowBox[{"[", "n", "]"}], "]"}]}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "Nparticles"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "plot", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"zBC2Plot", "=", 
     RowBox[{"Histogram", "[", 
      RowBox[{"zBC2", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Raw\>\"", ",", "Nbins"}], "}"}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<z, [m]\>\"", ",", "\"\<Entries\>\""}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "4"}], "*", "\[Sigma]zGun"}], ",", 
            RowBox[{"4", "*", "\[Sigma]zGun"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Nparticles", "/", "10"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<after BC2\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"zBC2PlotNoZoom", "=", 
     RowBox[{"Histogram", "[", 
      RowBox[{"zBC2", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Raw\>\"", ",", "Nbins"}], "}"}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<z, [m]\>\"", ",", "\"\<Entries\>\""}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<after BC2\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"z\[Delta]BC2Plot", "=", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"zBC2", "[", 
            RowBox[{"[", "n", "]"}], "]"}], ",", 
           RowBox[{"\[Delta]BC2", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "Nparticles"}], "}"}]}], "]"}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<z, [m]\>\"", ",", "\"\<\[Delta]\>\""}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], "*", "\[Sigma]zGun"}], ",", 
            RowBox[{"3", "*", "\[Sigma]zGun"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.05"}], ",", "0.05"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<after BC2\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"GraphicsGrid", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"zACC39Plot", ",", "z\[Delta]ACC39Plot"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"zBC2Plot", ",", "z\[Delta]BC2Plot"}], "}"}], ",", 
       RowBox[{"{", "zBC2PlotNoZoom", "}"}]}], "}"}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Phi]ACC1", ",", "0"}], "}"}], ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Phi]ACC39", ",", "180"}], "}"}], ",", "160", ",", "180"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ratio", ",", "9"}], "}"}], ",", "1", ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"ratio", ",", 
     RowBox[{"{", "10000", "}"}]}], "}"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.7074725741858673`*^9, 3.707472600629198*^9}, {
   3.707473094199935*^9, 3.707473117606114*^9}, {3.707473152582245*^9, 
   3.707473250789185*^9}, {3.707473287478292*^9, 3.7074734153160763`*^9}, {
   3.707473802495926*^9, 3.707473829906228*^9}, {3.707474010849021*^9, 
   3.707474018444368*^9}, {3.707474144833406*^9, 3.707474153212778*^9}, {
   3.707474219388588*^9, 3.707474225549535*^9}, {3.707474350125764*^9, 
   3.7074743503165493`*^9}, {3.70747439381155*^9, 3.707474711209902*^9}, {
   3.707474772432659*^9, 3.707474781504056*^9}, {3.707474828775755*^9, 
   3.7074749480673523`*^9}, {3.707475928252524*^9, 3.707475944771616*^9}, {
   3.707475976659181*^9, 3.707475979211751*^9}, {3.707476176281188*^9, 
   3.7074762241529207`*^9}, {3.707476260921332*^9, 3.707476307225479*^9}, {
   3.7074765254777203`*^9, 3.707476574596994*^9}, {3.7074766334519987`*^9, 
   3.707476646025297*^9}, {3.707476709771475*^9, 3.707476718696227*^9}, 
   3.70747705274257*^9, {3.707477104934103*^9, 3.7074771070535383`*^9}, 
   3.7074771928292828`*^9, {3.707477315707758*^9, 3.707477333339155*^9}, {
   3.707477366442072*^9, 3.707477421635207*^9}, {3.707477978805097*^9, 
   3.707478006004116*^9}, {3.70747832074601*^9, 3.7074783219760723`*^9}, {
   3.707478432415753*^9, 3.707478467805945*^9}, {3.70747984500803*^9, 
   3.7074799077980003`*^9}, {3.7074803118226023`*^9, 3.707480329276911*^9}, {
   3.707480440391755*^9, 3.7074804534972363`*^9}, {3.707480646637171*^9, 
   3.707480684564834*^9}, {3.7074807149687233`*^9, 3.707480724071097*^9}, {
   3.707552778426306*^9, 3.707552781197618*^9}, {3.707552826535198*^9, 
   3.7075528450480824`*^9}, {3.707552979843903*^9, 3.707553016406752*^9}, 
   3.707553084198223*^9, {3.707553121945013*^9, 3.7075531371114397`*^9}, {
   3.7075532423243504`*^9, 3.707553263261408*^9}, {3.707553295703418*^9, 
   3.707553365149396*^9}},ExpressionUUID->"92bfd623-8af6-4111-98f1-\
2473cc6a17d3"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`ratio$$ = 9, $CellContext`\[Phi]ACC1$$ = 
    0, $CellContext`\[Phi]ACC39$$ = 180, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`\[Phi]ACC1$$], 0}, -10, 10}, {{
       Hold[$CellContext`\[Phi]ACC39$$], 180}, 160, 180}, {{
       Hold[$CellContext`ratio$$], 9}, 1, 15}, {
      Hold[$CellContext`ratio$$], {10000}}}, Typeset`size$$ = {
    360., {168., 171.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`\[Phi]ACC1$6166$$ = 
    0, $CellContext`\[Phi]ACC39$6167$$ = 0, $CellContext`ratio$6168$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`ratio$$ = 9, $CellContext`\[Phi]ACC1$$ = 
        0, $CellContext`\[Phi]ACC39$$ = 180}, "ControllerVariables" :> {
        Hold[$CellContext`\[Phi]ACC1$$, $CellContext`\[Phi]ACC1$6166$$, 0], 
        Hold[$CellContext`\[Phi]ACC39$$, $CellContext`\[Phi]ACC39$6167$$, 0], 
        
        Hold[$CellContext`ratio$$, $CellContext`ratio$6168$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`\[Delta]ACC39 = 
        ConstantArray[
         0, $CellContext`Nparticles]; $CellContext`EACC39 = $CellContext`EGun + \
$CellContext`Wtot[
          0, $CellContext`\[Phi]ACC1$$, $CellContext`\[Phi]ACC39$$, \
$CellContext`ratio$$]; 
       Do[Part[$CellContext`\[Delta]ACC39, $CellContext`n] = ((1 + 
             Part[$CellContext`\[Delta]Gun, $CellContext`n]) \
$CellContext`EGun + $CellContext`Wtot[
             
             Part[$CellContext`zGun, $CellContext`n], \
$CellContext`\[Phi]ACC1$$, $CellContext`\[Phi]ACC39$$, $CellContext`ratio$$] - \
$CellContext`EACC39)/$CellContext`EACC39, {$CellContext`n, \
$CellContext`Nparticles}]; $CellContext`zACC39 = $CellContext`zGun; \
$CellContext`zACC39Plot = 
        Histogram[$CellContext`zACC39, $CellContext`Nbins, 
          AxesLabel -> {"z, [m]", "Entries"}, 
          PlotRange -> {{(-4) $CellContext`\[Sigma]zGun, 
             4 $CellContext`\[Sigma]zGun}, {0, $CellContext`Nparticles/10}}, 
          PlotLabel -> "after ACC39"]; $CellContext`z\[Delta]ACC39Plot = 
        ListPlot[
          Table[{
            Part[$CellContext`zACC39, $CellContext`n], 
            
            Part[$CellContext`\[Delta]ACC39, $CellContext`n]}, \
{$CellContext`n, $CellContext`Nparticles}], 
          AxesLabel -> {"z, [m]", "\[Delta]"}, 
          PlotRange -> {{(-3) $CellContext`\[Sigma]zGun, 
             3 $CellContext`\[Sigma]zGun}, {-0.05, 0.05}}, PlotLabel -> 
          "after ACC39"]; $CellContext`\[Delta]BC2 = \
$CellContext`\[Delta]ACC39; $CellContext`zBC2 = 
        ConstantArray[0, $CellContext`Nparticles]; 
       Do[Part[$CellContext`zBC2, $CellContext`n] = 
         Part[$CellContext`zACC39, $CellContext`n] + $CellContext`R56 
           Part[$CellContext`\[Delta]ACC39, $CellContext`n], {$CellContext`n, \
$CellContext`Nparticles}]; $CellContext`zBC2Plot = 
        Histogram[$CellContext`zBC2, {"Raw", $CellContext`Nbins}, 
          AxesLabel -> {"z, [m]", "Entries"}, 
          PlotRange -> {{(-4) $CellContext`\[Sigma]zGun, 
             4 $CellContext`\[Sigma]zGun}, {0, $CellContext`Nparticles/10}}, 
          PlotLabel -> "after BC2"]; $CellContext`zBC2PlotNoZoom = 
        Histogram[$CellContext`zBC2, {"Raw", $CellContext`Nbins}, 
          AxesLabel -> {"z, [m]", "Entries"}, PlotLabel -> 
          "after BC2"]; $CellContext`z\[Delta]BC2Plot = ListPlot[
          Table[{
            Part[$CellContext`zBC2, $CellContext`n], 
            
            Part[$CellContext`\[Delta]BC2, $CellContext`n]}, {$CellContext`n, \
$CellContext`Nparticles}], AxesLabel -> {"z, [m]", "\[Delta]"}, 
          PlotRange -> {{(-3) $CellContext`\[Sigma]zGun, 
             3 $CellContext`\[Sigma]zGun}, {-0.05, 0.05}}, PlotLabel -> 
          "after BC2"]; 
       GraphicsGrid[{{$CellContext`zACC39Plot, \
$CellContext`z\[Delta]ACC39Plot}, {$CellContext`zBC2Plot, $CellContext`z\
\[Delta]BC2Plot}, {$CellContext`zBC2PlotNoZoom}}]), 
      "Specifications" :> {{{$CellContext`\[Phi]ACC1$$, 0}, -10, 
         10}, {{$CellContext`\[Phi]ACC39$$, 180}, 160, 
         180}, {{$CellContext`ratio$$, 9}, 1, 15}, {$CellContext`ratio$$, {
         10000}}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{407., {285., 290.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.7075528477510157`*^9, 3.707552861522826*^9}, {
   3.707553024271669*^9, 3.707553031781847*^9}, {3.707553073049374*^9, 
   3.707553089312004*^9}, 3.7075531262300262`*^9, 3.707553264202845*^9, 
   3.707553325877643*^9, 3.707553439409935*^9, 3.7504895595146227`*^9, 
   3.75058661410577*^9},ExpressionUUID->"6c8e3c11-f61b-4922-9aa3-\
c68bb7939134"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"triagnular", " ", "'"}], 
    RowBox[{"driver", "'"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"4", ",", " ", "165.5", ",", " ", "7.18"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"4", ",", " ", "163.86", ",", " ", "6.46"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"triagnular", " ", "'"}], 
    RowBox[{"witness", "'"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"10", ",", " ", "180", ",", " ", "14.58"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.7074814916800327`*^9, 3.707481525757098*^9}, {
  3.707553667453607*^9, 3.707553681652796*^9}, {3.707554046556816*^9, 
  3.7075540900022907`*^9}},ExpressionUUID->"e195365d-8531-4282-947f-\
8d11dcf821ce"]
},
WindowSize->{1920, 1155},
WindowMargins->{{0, Automatic}, {-7, Automatic}},
FrontEndVersion->"11.1 for Linux x86 (64-bit) (March 13, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 580, 11, 55, "Text", "ExpressionUUID" -> \
"e1ecb0fe-3d19-4cb6-9cbf-8f8d840c61be"],
Cell[1141, 33, 344, 9, 34, "Input", "ExpressionUUID" -> \
"e61e06a4-606e-4bae-a2ae-ac47e515f92e"],
Cell[1488, 44, 1184, 29, 152, "Input", "ExpressionUUID" -> \
"9e2969cd-09fc-41a4-80e2-ea427fb23413"],
Cell[2675, 75, 1718, 40, 103, "Input", "ExpressionUUID" -> \
"ed396355-5d8b-46c0-aa50-c5ebd509f57f"],
Cell[CellGroupData[{
Cell[4418, 119, 6575, 139, 469, "Input", "ExpressionUUID" -> \
"63f240a5-162a-463a-9f55-07e2334038d3"],
Cell[10996, 260, 3728, 74, 504, "Output", "ExpressionUUID" -> \
"e62f4fa0-4745-44af-b5db-b4763e4a4be4"]
}, Open  ]],
Cell[14739, 337, 171, 3, 33, "Text", "ExpressionUUID" -> \
"b4f5511c-ad38-4012-8c0f-e87922ba57be"],
Cell[14913, 342, 1537, 41, 173, "Input", "ExpressionUUID" -> \
"a99dbb26-05ae-4e90-bb96-3070add2100c"],
Cell[CellGroupData[{
Cell[16475, 387, 1779, 48, 80, "Input", "ExpressionUUID" -> \
"9c7f2bf6-f2cb-4eee-91c3-c16ac1404622"],
Cell[18257, 437, 18665, 348, 134, "Output", "ExpressionUUID" -> \
"8453ef13-cafc-4e18-97e5-ec7a723b0273"]
}, Open  ]],
Cell[36937, 788, 227, 4, 33, "Text", "ExpressionUUID" -> \
"ec4cdc20-f378-4a38-b337-9ed9572afe0d"],
Cell[CellGroupData[{
Cell[37189, 796, 9323, 222, 465, "Input", "ExpressionUUID" -> \
"92bfd623-8af6-4111-98f1-2473cc6a17d3"],
Cell[46515, 1020, 5517, 103, 592, "Output", "ExpressionUUID" -> \
"6c8e3c11-f61b-4922-9aa3-c68bb7939134"]
}, Open  ]],
Cell[52047, 1126, 818, 21, 124, "Input", "ExpressionUUID" -> \
"e195365d-8531-4282-947f-8d11dcf821ce"]
}
]
*)

